<!DOCTYPE html>
<html lang="ar">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=3.0">
    <title>آية وهداية</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #f8f9fa;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            flex-direction: column;
            overflow-x: hidden;
        }

        .card-container {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            width: 100%;
            max-width: 100%;
            padding: 0 10px;
            box-sizing: border-box;
        }

        .card {
            direction: rtl;
            width: 100%;
            max-width: 465px;
            height: auto;
            aspect-ratio: 1;
            border: none;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            background-image: url('background1.jpeg');
            background-size: cover;
            background-position: center;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #cardBody {
            padding: 40px;
            background-color: rgba(255, 255, 255, 0.0);
            border-radius: 10px;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100%;
        }

        .verse,
        .explanation,
        .author {
            text-shadow: 1px 1px 3px rgba(255, 255, 255, 0.6);
        }

        .verse {
            font-size: 36px;
            color: #000000;
            margin-bottom: 20px;
        }

        .explanation {
            font-size: 21px;
            color: #000000;
            line-height: 1.6;
        }

        .author {
            font-size: 18px;
            color: #000000;
            margin-top: 10px;
        }

        .qq {
            font-family: 'Noto Sans', 'Arial Unicode MS', sans-serif;
        }

        .arrow-button {
            background-color: rgba(255, 255, 255, 0.7);
            border: none;
            font-size: 1.5rem;
            color: #333;
            width: 40px;
            height: 40px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            margin: 0 10px;
        }

        .control-buttons {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .control-button {
            margin: 5px;
            padding: 8px 16px;
            font-size: 0.9rem;
            cursor: pointer;
        }

        .active {
            background-color: teal;
            color: white;
        }

        .counter {
            margin-top: 10px;
            font-size: 1rem;
        }

        .checkbox-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .form-check {
            display: flex;
            align-items: center;
        }

        .form-check-label {
            margin-left: 5px;
        }

        .upload-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>

<body>
    <div class="control-buttons">
        <button class="control-button btn btn-secondary" onclick="setMode('textColor', this)">لون النص</button>
        <button class="control-button btn btn-secondary" onclick="setMode('textSize', this)">حجم النص</button>
        <button class="control-button btn btn-secondary" onclick="setMode('textContent', this)">النص</button>
        <button class="control-button btn btn-secondary active" onclick="setMode('background', this)">الخلفية</button>
    </div>
    <div class="card-container">
        <button class="arrow-button" onclick="changeContent(-1)">&lt;</button>
        <div class="card" id="card">
            <div id="cardBody">
                <div class="verse" id="verse" contenteditable="false">
                    العنوان أو
                    <span class="qq">﴿</span>
                    الآية
                    <span class="qq">﴾</span>
                </div>
                <div class="explanation" id="explanation" contenteditable="false">
                    ❞
                    النص
                    ❝
                </div>
                <div class="author" id="author">
                    - الكاتب -
                </div>
            </div>
        </div>
        <button class="arrow-button" onclick="changeContent(1)">&gt;</button>
    </div>
    <div class="counter" id="counter">
        الخلفية: 1 | حجم النص: 1 | لون النص: 1 | النص: 0
    </div>
    <div class="checkbox-container">
        <div class="form-check">
            <input class="form-check-input" type="checkbox" id="editTextToggle" onchange="toggleTextEdit()">
            <label class="form-check-label" for="editTextToggle">
                تعديل
            </label>
        </div>
        <div class="form-check">
            <input class="form-check-input" type="checkbox" id="textShadowToggle" checked onchange="toggleTextShadow()">
            <label class="form-check-label" for="textShadowToggle">
                ظل
            </label>
        </div>
        <div class="form-check">
            <input class="form-check-input" type="checkbox" id="authorToggle" checked onchange="toggleAuthor()">
            <label class="form-check-label" for="authorToggle">
                الكاتب
            </label>
        </div>
        <div class="form-check">
            <input class="form-check-input" type="checkbox" id="explanationToggle" checked
                onchange="toggleExplanation()">
            <label class="form-check-label" for="explanationToggle">
                النص
            </label>
        </div>
        <div class="form-check">
            <input class="form-check-input" type="checkbox" id="verseToggle" checked onchange="toggleVerse()">
            <label class="form-check-label" for="verseToggle">
                العنوان
            </label>
        </div>
    </div>
    <div class="upload-container">
        <label for="imageUpload" class="btn btn-primary">تحميل صورة</label>
        <input type="file" id="imageUpload" accept="image/*" onchange="uploadImage()" style="display: none;">
        <a id="btn-Convert-Html2Image" class="btn btn-success" href="#">حفظ الصورة</a>
    </div>

    <script>
        let currentBackground = 1;
        let currentTextSizeIndex = 10;
        let currentTextColorIndex = 0;
        let currentTextIndex = 0;
        let mode = 'background';

        const textSizes = [0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95,
            1,
            1.05, 1.1, 1.15, 1.2, 1.25, 1.3, 1.35, 1.4, 1.45, 1.5];

        const textColors = [
            { color: '#000000' }, // Black
            { color: '#FFFFFF' }, // White
            { color: '#FF5733' }, // Orange
            { color: '#4CAF50' }, // Green
            { color: '#2196F3' }, // Blue
            { color: '#FFC107' }, // Amber
            { color: '#9C27B0' }, // Purple
            { color: '#FFEB3B' }, // Yellow
            { color: '#E91E63' }, // Pink
            { color: '#00BCD4' }, // Cyan
            { color: '#8BC34A' }, // Light Green
            { color: '#FF9800' }, // Deep Orange
            { color: '#795548' }, // Brown
            { color: '#607D8B' }, // Blue Gray
            { color: '#F44336' }, // Red
            { color: '#3F51B5' }, // Indigo
            { color: '#CDDC39' }, // Lime
            { color: '#673AB7' }, // Deep Purple
            { color: '#FF5722' }, // Burnt Orange
            { color: '#009688' }, // Teal
        ];
        const texts = [
            {
                "verse": "بِسْمِ اللَّهِ الرَّحْمَٰنِ الرَّحِيمِ",
                "explanation": "❞ " + "النص" + " ❝",
                "author": "الكاتب"
            }
        ];

        // Fetch data from the JSON API
        fetch('https://abdallahdaoud.github.io/cardsJSON/data.json')
            .then(response => response.json())
            .then(data => {
                texts.push(...data);
            })
            .catch(error => console.error('Error fetching data:', error));

        function setMode(newMode, button) {
            mode = newMode;
            document.querySelectorAll('.control-button').forEach(btn => btn.classList.remove('active'));
            button.classList.add('active');
        }

        function changeContent(direction) {
            if (mode === 'background') {
                currentBackground += direction;
                if (currentBackground < 1) {
                    currentBackground = 26;
                } else if (currentBackground > 26) {
                    currentBackground = 1;
                }
                document.getElementById('card').style.backgroundImage = `url('background${currentBackground}.jpeg')`;
            } else if (mode === 'textColor') {
                currentTextColorIndex = (currentTextColorIndex + direction + textColors.length) % textColors.length;
                const colorInfo = textColors[currentTextColorIndex];
                document.getElementById('verse').style.color = colorInfo.color;
                document.getElementById('explanation').style.color = colorInfo.color;
                document.getElementById('author').style.color = colorInfo.color;
            } else if (mode === 'textSize') {
                currentTextSizeIndex = (currentTextSizeIndex + direction + textSizes.length) % textSizes.length;
                const sizeFactor = textSizes[currentTextSizeIndex];
                if (window.screen.width > 800) {
                    document.getElementById('verse').style.fontSize = `${36 * sizeFactor}px`;
                    document.getElementById('explanation').style.fontSize = `${21 * sizeFactor}px`;
                    document.getElementById('author').style.fontSize = `${18 * sizeFactor}px`;
                }
                else {
                    document.getElementById('verse').style.fontSize = `${24 * sizeFactor}px`;
                    document.getElementById('explanation').style.fontSize = `${14 * sizeFactor}px`;
                    document.getElementById('author').style.fontSize = `${12 * sizeFactor}px`;
                }
            } else if (mode === 'textContent') {
                currentTextIndex = (currentTextIndex + direction + texts.length) % texts.length;
                const textInfo = texts[currentTextIndex];
                document.getElementById('verse').innerHTML = `<span class="qq">﴿</span> ${textInfo.verse} <span class="qq">﴾</span>`;
                document.getElementById('explanation').textContent = textInfo.explanation;
                document.getElementById('author').textContent = "- " + textInfo.author + " -";
            }
            updateCounter();
        }

        function updateCounter() {
            document.getElementById('counter').textContent = `الخلفية: ${currentBackground} | حجم النص: ${textSizes[currentTextSizeIndex]} | لون النص: ${currentTextColorIndex + 1} | النص: ${currentTextIndex}`;
        }

        function toggleTextShadow() {
            const isChecked = document.getElementById('textShadowToggle').checked;
            const textShadowValue = isChecked ? '1px 1px 3px rgba(255, 255, 255, 0.6)' : 'none';
            document.getElementById('verse').style.textShadow = textShadowValue;
            document.getElementById('explanation').style.textShadow = textShadowValue;
            document.getElementById('author').style.textShadow = textShadowValue;
        }

        function toggleTextEdit() {
            const isEditable = document.getElementById('editTextToggle').checked;
            document.getElementById('verse').contentEditable = isEditable;
            document.getElementById('explanation').contentEditable = isEditable;
            document.getElementById('author').contentEditable = isEditable;
        }

        function toggleVerse() {
            const isChecked = document.getElementById('verseToggle').checked;
            document.getElementById('verse').style.display = isChecked ? 'block' : 'none';
        }

        function toggleExplanation() {
            const isChecked = document.getElementById('explanationToggle').checked;
            document.getElementById('explanation').style.display = isChecked ? 'block' : 'none';
        }

        function toggleAuthor() {
            const isChecked = document.getElementById('authorToggle').checked;
            document.getElementById('author').style.display = isChecked ? 'block' : 'none';
        }

        function uploadImage() {
            const fileInput = document.getElementById('imageUpload');
            const file = fileInput.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    document.getElementById('card').style.backgroundImage = `url('${e.target.result}')`;
                };
                reader.readAsDataURL(file);
            }
        }

        function onPageLoad() {
            const direction = 0;
            currentTextSizeIndex = (currentTextSizeIndex + direction + textSizes.length) % textSizes.length;
            const sizeFactor = textSizes[currentTextSizeIndex];
            if (window.screen.width > 800) {
                document.getElementById('cardBody').style.padding = "40px";
                document.getElementById('verse').style.fontSize = `${36 * sizeFactor}px`;
                document.getElementById('explanation').style.fontSize = `${21 * sizeFactor}px`;
                document.getElementById('author').style.fontSize = `${18 * sizeFactor}px`;
            }
            else {
                document.getElementById('cardBody').style.padding = "30px";
                document.getElementById('verse').style.fontSize = `${24 * sizeFactor}px`;
                document.getElementById('explanation').style.fontSize = `${14 * sizeFactor}px`;
                document.getElementById('author').style.fontSize = `${12 * sizeFactor}px`;

            }
        }

        window.onload = onPageLoad;

        document.getElementById('btn-Convert-Html2Image').addEventListener('click', function () {
            html2canvas(document.querySelector("#card"), { scale: 3 }).then(canvas => {
                canvas.toBlob(function (blob) {
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'card.jpeg';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                }, 'image/jpeg', 0.95);
            });
        });

    </script>
</body>

</html>
